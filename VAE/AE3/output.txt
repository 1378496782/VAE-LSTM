模型保存路径： AE3/model.pth
运行日志已保存至：AE3/output.txt
(125973, 42)
(22544, 42)
(148517, 42)
78517
normal_df.shape = (37235, 41)
anomaly_df.shape = (32765, 41)
[[0.         0.         0.23880597 ... 0.         0.05       0.        ]
 [0.         0.5        0.6119403  ... 0.         0.         0.        ]
 [0.         0.         0.29850746 ... 0.01       0.         0.01      ]
 ...
 [0.         0.         0.23880597 ... 0.         0.08       0.        ]
 [0.         0.5        0.11940299 ... 0.         0.         0.        ]
 [0.         0.         0.29850746 ... 0.         0.         0.        ]]
####################################################################################################
[[0.         0.         0.68115942 ... 1.         0.         0.        ]
 [0.         0.         0.68115942 ... 0.         1.         1.        ]
 [0.         0.         0.68115942 ... 1.         0.         0.        ]
 ...
 [0.         0.         0.8115942  ... 1.         0.         0.        ]
 [0.         1.         0.17391304 ... 0.         0.         0.        ]
 [0.         0.         0.68115942 ... 1.         0.         0.        ]]
训练集形状 = (31649, 41)
验证集形状 = (3742, 41)
测试集形状 = (1844, 41)
异常测试集形状 = (32765, 1, 41)
重塑后训练集形状 = (31649, 1, 41)
重塑后验证集形状 = (3742, 1, 41)
重塑后测试集形状 = (1844, 1, 41)
数据类型 = <class 'numpy.ndarray'>
发现已有训练模型，直接加载...
无训练历史数据，跳过绘图步骤
正常训练集重构损失均值 0.1253774030986909
正常测试集重构损失均值 0.1332127658038909
df2中正常数据的数量 39819
df2中异常数据的数量 38698
最佳阈值为： 0.4335335335335335
Correct normal predictions: 1718/1844
Accuracy: 0.9316702819956616
Correct anormaly predictions: 1758/1844
Accuracy: 0.9533622559652929
37289 / 39819
正常数据检测准确率 0.9364624927798287
34236 / 38698
异常数据检测准确率 0.8846968835598739
准确率: 0.9109492211877682
精确率: 0.9364624927798287
召回率: 0.8931283083039927
f1分数: 0.914282211597401
