模型保存路径： AE4/model.pth
运行日志已保存至：AE4/output.txt
(125973, 42)
(22544, 42)
(148517, 42)
78517
normal_df.shape = (37235, 41)
anomaly_df.shape = (32765, 41)
[[0.         0.         0.23880597 ... 0.         0.05       0.        ]
 [0.         0.5        0.6119403  ... 0.         0.         0.        ]
 [0.         0.         0.29850746 ... 0.01       0.         0.01      ]
 ...
 [0.         0.         0.23880597 ... 0.         0.08       0.        ]
 [0.         0.5        0.11940299 ... 0.         0.         0.        ]
 [0.         0.         0.29850746 ... 0.         0.         0.        ]]
####################################################################################################
[[0.         0.         0.68115942 ... 1.         0.         0.        ]
 [0.         0.         0.68115942 ... 0.         1.         1.        ]
 [0.         0.         0.68115942 ... 1.         0.         0.        ]
 ...
 [0.         0.         0.8115942  ... 1.         0.         0.        ]
 [0.         1.         0.17391304 ... 0.         0.         0.        ]
 [0.         0.         0.68115942 ... 1.         0.         0.        ]]
训练集形状 = (31649, 41)
验证集形状 = (3742, 41)
测试集形状 = (1844, 41)
异常测试集形状 = (32765, 1, 41)
重塑后训练集形状 = (31649, 1, 41)
重塑后验证集形状 = (3742, 1, 41)
重塑后测试集形状 = (1844, 1, 41)
数据类型 = <class 'numpy.ndarray'>
未找到预训练模型，开始训练...
Epoch 1: train loss 0.4142489161372302 val loss 0.22258041949381724
Epoch 2: train loss 0.1956564707554116 val loss 0.18037570472666073
Epoch 3: train loss 0.16640033539446444 val loss 0.16028178144940228
Epoch 4: train loss 0.15204155144829723 val loss 0.1493671470162305
Epoch 5: train loss 0.1435093000346482 val loss 0.14324812093489062
Epoch 6: train loss 0.1361060682562256 val loss 0.13445088633035973
Epoch 7: train loss 0.12955653809651713 val loss 0.1324803173181888
Epoch 8: train loss 0.12371012850299387 val loss 0.12343073631424625
Epoch 9: train loss 0.11851592254562875 val loss 0.117595453749479
Epoch 10: train loss 0.11455993816793533 val loss 0.11502643199175853
Epoch 11: train loss 0.11284838440829177 val loss 0.11042930582552682
Epoch 12: train loss 0.10803784229535374 val loss 0.10388311422259494
Epoch 13: train loss 0.1050876306427038 val loss 0.10184973131964567
Epoch 14: train loss 0.1028436232200704 val loss 0.10346165551736931
Epoch 15: train loss 0.10102755702598207 val loss 0.09856207886031808
Epoch 16: train loss 0.09925753107141948 val loss 0.09899583664375672
Epoch 17: train loss 0.09814720179648959 val loss 0.09703062303729015
Epoch 18: train loss 0.09600084501988343 val loss 0.09358504153804578
Epoch 19: train loss 0.09536375794543331 val loss 0.09389846692427835
Epoch 20: train loss 0.09385873612141193 val loss 0.0939982791458252
Epoch 21: train loss 0.0925044267322483 val loss 0.091020555975501
Epoch 22: train loss 0.09246841575305463 val loss 0.09511288650935433
Epoch 23: train loss 0.09184414630376617 val loss 0.0915203890250834
Epoch 24: train loss 0.09090783662696254 val loss 0.09149545453844606
Epoch 25: train loss 0.0897162156903644 val loss 0.09260362504154791
Epoch 26: train loss 0.08906322594181655 val loss 0.09129838534199458
Epoch 27: train loss 0.0890060765532992 val loss 0.0900438955427137
Epoch 28: train loss 0.08768521390491217 val loss 0.08916508045895842
Epoch 29: train loss 0.0871817395635072 val loss 0.08964794787803773
Epoch 30: train loss 0.08701887760147911 val loss 0.0911868771521712
Epoch 31: train loss 0.08650897394530965 val loss 0.0891066055753224
Epoch 32: train loss 0.08603055394249855 val loss 0.08820695962436684
Epoch 33: train loss 0.0857067694206716 val loss 0.08813206326493467
Epoch 34: train loss 0.08595021272925989 val loss 0.08468421860482608
Epoch 35: train loss 0.08476068996378161 val loss 0.0894484302523172
Epoch 36: train loss 0.08443180626441814 val loss 0.0864524210079955
Epoch 37: train loss 0.08405101023492496 val loss 0.08529095119873349
Epoch 38: train loss 0.08404684050485388 val loss 0.08455855015604068
Epoch 39: train loss 0.08324387417790285 val loss 0.08465124896261095
Epoch 40: train loss 0.08316733262692907 val loss 0.08369655556943693
Epoch 41: train loss 0.08285140936312758 val loss 0.0854259299647642
Epoch 42: train loss 0.08274894986188323 val loss 0.08510295572728745
Epoch 43: train loss 0.086266800537348 val loss 0.08733771614948006
Epoch 44: train loss 0.08508032274762405 val loss 0.08666625040109065
Epoch 45: train loss 0.08312978972335895 val loss 0.08367213710034012
Epoch 46: train loss 0.08166047244340838 val loss 0.08303163742526737
Epoch 47: train loss 0.0815017582216706 val loss 0.08545889414368792
Epoch 48: train loss 0.08122717045569879 val loss 0.08390788889785245
Epoch 49: train loss 0.08169838843664584 val loss 0.08342075851858648
Epoch 50: train loss 0.08080224569691812 val loss 0.081526843672902
Epoch 51: train loss 0.08036222315955366 val loss 0.08123909917841805
Epoch 52: train loss 0.08067640495543822 val loss 0.08239200610343544
Epoch 53: train loss 0.08013243560089828 val loss 0.08412067891765691
Epoch 54: train loss 0.0822941234746553 val loss 0.08382705932399452
Epoch 55: train loss 0.08053543247878037 val loss 0.08420196641248988
Epoch 56: train loss 0.08141203667753635 val loss 0.08619130715843039
Epoch 57: train loss 0.08108723736159908 val loss 0.08517281199085668
Epoch 58: train loss 0.08109512063211252 val loss 0.081511367114047
Epoch 59: train loss 0.07996032283139902 val loss 0.08273756028778198
Epoch 60: train loss 0.0797231360324522 val loss 0.08316829269481868
Epoch 61: train loss 0.08023160069990352 val loss 0.08417528670104837
Epoch 62: train loss 0.08060215736956086 val loss 0.08376267416236444
Epoch 63: train loss 0.08161960458072164 val loss 0.08570702190268019
Epoch 64: train loss 0.08116342466044324 val loss 0.08637429547662519
Epoch 65: train loss 0.08066000247698583 val loss 0.08070449948054875
Epoch 66: train loss 0.07969080953558189 val loss 0.08499265179658515
Epoch 67: train loss 0.07920569393148741 val loss 0.08318305449965467
Epoch 68: train loss 0.07903053834504674 val loss 0.08230627618402413
Epoch 69: train loss 0.07894768304492608 val loss 0.08353537382788952
Epoch 70: train loss 0.08327185465202075 val loss 0.08639907149074351
Epoch 71: train loss 0.08177506787527011 val loss 0.08666153391854282
Epoch 72: train loss 0.08113574907644579 val loss 0.0857122329326348
Epoch 73: train loss 0.08099805296293054 val loss 0.08579497289368365
Epoch 74: train loss 0.08005268263689794 val loss 0.08603918581393626
Epoch 75: train loss 0.07983152522306335 val loss 0.08421301314867843
Epoch 76: train loss 0.07968269618708125 val loss 0.08475857035186986
Epoch 77: train loss 0.08011090142031439 val loss 0.08532657654440047
Epoch 78: train loss 0.07929374370386569 val loss 0.08238428812558633
Epoch 79: train loss 0.07856995057330202 val loss 0.08419849884493216
Epoch 80: train loss 0.07859706513286135 val loss 0.08417287658596882
Epoch 81: train loss 0.0785881046207052 val loss 0.08537830898140267
Epoch 82: train loss 0.07816317519257315 val loss 0.08308911687278356
Epoch 83: train loss 0.07875982226045616 val loss 0.08294749809035813
Epoch 84: train loss 0.07870531719380167 val loss 0.08481225688818081
Epoch 85: train loss 0.07860907262162728 val loss 0.08337117914463339
Epoch 86: train loss 0.07824572621368851 val loss 0.08241090623260303
Epoch 87: train loss 0.0779688600350998 val loss 0.08234612257488645
Epoch 88: train loss 0.07854858013624508 val loss 0.08165945119617973
Epoch 89: train loss 0.07758094625288821 val loss 0.08481393681901578
Epoch 90: train loss 0.07737431885042137 val loss 0.08427365317228656
Epoch 91: train loss 0.07814243180126126 val loss 0.08203088791033214
Epoch 92: train loss 0.07777762554526035 val loss 0.08189228121414015
Epoch 93: train loss 0.07713516025832162 val loss 0.08010686267701683
Epoch 94: train loss 0.07708626309800162 val loss 0.08367087646700613
Epoch 95: train loss 0.07809887784415276 val loss 0.085842258816016
Epoch 96: train loss 0.07790074695580985 val loss 0.08377995824564262
Epoch 97: train loss 0.07761824775980304 val loss 0.08433142538588864
Epoch 98: train loss 0.07827695316659812 val loss 0.08246806380581628
Epoch 99: train loss 0.07802011381875965 val loss 0.08318108184115522
Epoch 100: train loss 0.07866695870164712 val loss 0.07987367804899521
正常训练集重构损失均值 0.07599045388558899
正常测试集重构损失均值 0.08523453197156891
df2中正常数据的数量 39819
df2中异常数据的数量 38698
最佳阈值为： 0.4573573573573574
Correct normal predictions: 1770/1844
Accuracy: 0.9598698481561823
Correct anormaly predictions: 1760/1844
Accuracy: 0.9544468546637744
38379 / 39819
正常数据检测准确率 0.9638363595268591
34153 / 38698
异常数据检测准确率 0.8825520698744121
准确率: 0.9237744692232256
精确率: 0.9638363595268591
召回率: 0.8941151803187029
f1分数: 0.9276675972589826
