模型保存路径： AE5/model.pth
运行日志已保存至：AE5/output.txt
(125973, 42)
(22544, 42)
(148517, 42)
78517
normal_df.shape = (37235, 41)
anomaly_df.shape = (32765, 41)
[[0.         0.         0.23880597 ... 0.         0.05       0.        ]
 [0.         0.5        0.6119403  ... 0.         0.         0.        ]
 [0.         0.         0.29850746 ... 0.01       0.         0.01      ]
 ...
 [0.         0.         0.23880597 ... 0.         0.08       0.        ]
 [0.         0.5        0.11940299 ... 0.         0.         0.        ]
 [0.         0.         0.29850746 ... 0.         0.         0.        ]]
####################################################################################################
[[0.         0.         0.68115942 ... 1.         0.         0.        ]
 [0.         0.         0.68115942 ... 0.         1.         1.        ]
 [0.         0.         0.68115942 ... 1.         0.         0.        ]
 ...
 [0.         0.         0.8115942  ... 1.         0.         0.        ]
 [0.         1.         0.17391304 ... 0.         0.         0.        ]
 [0.         0.         0.68115942 ... 1.         0.         0.        ]]
训练集形状 = (31649, 41)
验证集形状 = (3742, 41)
测试集形状 = (1844, 41)
异常测试集形状 = (32765, 1, 41)
重塑后训练集形状 = (31649, 1, 41)
重塑后验证集形状 = (3742, 1, 41)
重塑后测试集形状 = (1844, 1, 41)
数据类型 = <class 'numpy.ndarray'>
发现已有训练模型，直接加载...
无训练历史数据，跳过绘图步骤
正常训练集重构损失均值 0.11514152532904891
正常测试集重构损失均值 0.12102274417532118
df2中正常数据的数量 39819
df2中异常数据的数量 38698
最佳阈值为： 0.32632632632632635
Correct normal predictions: 1683/1844
Accuracy: 0.9126898047722343
Correct anormaly predictions: 1776/1844
Accuracy: 0.9631236442516269
36718 / 39819
正常数据检测准确率 0.9221226047866596
35116 / 38698
异常数据检测准确率 0.9074370768515169
预测结果已保存至：AE5/prediction_results.csv
准确率: 0.9148846746564439
精确率: 0.9221226047866596
召回率: 0.9111166253101737
f1分数: 0.9165865774660193
