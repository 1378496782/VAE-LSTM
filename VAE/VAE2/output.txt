模型保存路径： VAE2/model.pth
运行日志已保存至：VAE2/output.txt
(125973, 42)
(22544, 42)
(148517, 42)
78517
normal_df.shape = (37235, 41)
anomaly_df.shape = (32765, 41)
[[0.         0.         0.23880597 ... 0.         0.05       0.        ]
 [0.         0.5        0.6119403  ... 0.         0.         0.        ]
 [0.         0.         0.29850746 ... 0.01       0.         0.01      ]
 ...
 [0.         0.         0.23880597 ... 0.         0.08       0.        ]
 [0.         0.5        0.11940299 ... 0.         0.         0.        ]
 [0.         0.         0.29850746 ... 0.         0.         0.        ]]
####################################################################################################
[[0.         0.         0.68115942 ... 1.         0.         0.        ]
 [0.         0.         0.68115942 ... 0.         1.         1.        ]
 [0.         0.         0.68115942 ... 1.         0.         0.        ]
 ...
 [0.         0.         0.8115942  ... 1.         0.         0.        ]
 [0.         1.         0.17391304 ... 0.         0.         0.        ]
 [0.         0.         0.68115942 ... 1.         0.         0.        ]]
训练集形状 = (31649, 41)
验证集形状 = (3742, 41)
测试集形状 = (1844, 41)
异常测试集形状 = (32765, 1, 41)
重塑后训练集形状 = (31649, 1, 41)
重塑后验证集形状 = (3742, 1, 41)
重塑后测试集形状 = (1844, 1, 41)
数据类型 = <class 'numpy.ndarray'>
发现已有训练模型，直接加载...
无训练历史数据，跳过绘图步骤
正常训练集重构损失均值 1.1623180225816865
正常测试集重构损失均值 1.1497286481221172
df2中正常数据的数量 39819
df2中异常数据的数量 38698
最佳阈值为： 2.1369369369369373
Correct normal predictions: 1602/1844
Accuracy: 0.868763557483731
Correct anormaly predictions: 1780/1844
Accuracy: 0.96529284164859
34794 / 39819
正常数据检测准确率 0.8738039629322685
34407 / 38698
异常数据检测准确率 0.8891157165745
准确率: 0.8813505355528102
精确率: 0.8738039629322685
召回率: 0.8902136369451196
f1分数: 0.8819324749062152
df2中正常数据的数量 39819
df2中异常数据的数量 38698
最佳阈值为： 2.3394394394394395
Correct normal predictions: 1626/1844
Accuracy: 0.8817787418655098
Correct anormaly predictions: 1770/1844
Accuracy: 0.9598698481561823
35294 / 39819
正常数据检测准确率 0.886360782540998
33938 / 38698
异常数据检测准确率 0.8769962271952039
准确率: 0.8817453545092145
精确率: 0.886360782540998
召回率: 0.8811604334148899
f1分数: 0.8837529578205401
